name: FEA-GNN CI 

on:
  push:
    branches: [ "gnn_v3" ]
  pull_request:
    branches: [ "gnn_v3" ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Check out code
      uses: actions/checkout@v4

    - name: Install uv
      # L'action officielle gère le PATH et le cache automatiquement
      uses: astral-sh/setup-uv@v5
      with:
        enable-cache: true
        python-version: "3.14"

    - name: Install dependencies
      # 'uv sync' installe votre projet (src/fea_gnn) comme un package
      # ce qui permet à 'import fea_gnn' de fonctionner partout.
      run: uv sync

    - name: Debug Environment
      run: |
        echo "Structure des fichiers :"
        ls -R
        echo "Packages installés :"
        uv pip list

    - name: Run Pytest
      # 'uv run' exécute pytest dans l'environnement virtuel synchronisé
      run: uv run pytest tests/
